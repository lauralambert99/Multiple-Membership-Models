[["running-a-multiple-membership-model.html", "Chapter 5 Running a Multiple Membership Model 5.1 Intercept-only Model 5.2 The Output 5.3 Adding in level 1 predictors 5.4 Adding in level 2 predictors 5.5 Footnotes 5.6 Citations", " Chapter 5 Running a Multiple Membership Model As noted in 3.3, the only software currently able to run a multiple membership model is MLwiN (add ref). There is an R package, R2MLwiN (Zhang et al. 2023) that allows for an R-interface which runs MLwiN in the background. This allows users to work with a program they are already familiar with while accessing the capabilities of MLwiN. However, as also previously noted, you must have an active MLwiN license, and have the program installed on your computer for your R code to work. 5.1 Intercept-only Model We will first run an intercept-only model, looking at Math as an outcome and only including the intercept and the multiple membership effect of teachers. This model will inform us as to how the variance in Math scores is divided between teacher variance components (level 2) and student variance components (level 1). 5.1.1 First Steps Setting this up to run in R, we first need to make sure we have MLwiN installed, as well as call the R2MLwiN package. Additionally, R2MLwiN defaults the path to MLwiN as C:/Program Files/MLwiN v3.06/. If yours, like mine, is installed elsewhere, you need to include options(MLwiN_pah = \"path/to/MLwiN\"). An easy way to copy the path is to find it in your computer, hold shift and right click the program. The option copy as path comes up as an option, and you can just paste it in. 5.1.2 Define the model After we have loaded in the appropriate packages, we take a few steps to actually run the model. First, we define the intercept-only model, including both the teacher columns and the student IDs. For our dataset, our model definition will be intonly &lt;- Math ~ 1 + (1|tchr1) + (1|S_ID). Important to note is that when defining the teacher columns ((1|tchr1)), we use the first column name, not tchr as you might be inclined to do. 5.1.3 Set up and send to MLwiN The next step is to define the multiple membership variables (teacher columns for us) and the associated weights. To do this, we make an object that is a list of list of lists. I named it MultiMemb in the code chunk below: MultiMemb &lt;- list(list( mmvar = list(&quot;tchr1&quot;, &quot;tchr2&quot;, &quot;tchr3&quot;, &quot;tchr4&quot;, &quot;tchr5&quot;, &quot;tchr6&quot;, &quot;tchr7&quot;, &quot;tchr8&quot;, &quot;tchr9&quot;, &quot;tchr10&quot;, &quot;tchr11&quot;, &quot;tchr12&quot;), weights = list(&quot;w1&quot;, &quot;w2&quot;, &quot;w3&quot;, &quot;w4&quot;, &quot;w5&quot;, &quot;w6&quot;, &quot;w7&quot;, &quot;w8&quot;, &quot;w9&quot;, &quot;w10&quot;, &quot;w11&quot;, &quot;w12&quot;)), NA) Within this, mmvar specifies classification units (unit of multiple membership). weights is where the associated weights go, and is the student-level weighting (in our case) given to each teacher they had. The final NA indicates that level 1 has no multiple membership classification. This set-up is why our data needed to be in compact rather than long form (3.1). After we have defined MultiMemb, we can actually run the model. This line is putting everything together: (MMembModel1 &lt;- runMLwiN(Formula = intonly, data = StudData, estoptions = list(EstM = 1, drop.data = FALSE, mm = MultiMemb))) Looking at it, we are calling MLwiN with runMLwiN, defining what the model should be with Formula, and defining our data set with data. estoptions is our estimation options. When EstM is equal to 1, we are using MCMC estimation. And lastly, within that same statement, mm is calling our MultiMemb object to match everything up and weight appropriately. 5.1.4 Put it all together Taking everything from above and putting it all together, we get the following code chunk, and then output. library(R2MLwiN) options(MLwiN_path=&quot;C:\\\\Program Files (x86)\\\\MLwiN trial\\\\i386\\\\mlwin.exe&quot;) intonly &lt;- Math ~ 1 + (1|tchr1) + (1|S_ID) MultiMemb &lt;- list(list( mmvar = list(&quot;tchr1&quot;, &quot;tchr2&quot;, &quot;tchr3&quot;, &quot;tchr4&quot;, &quot;tchr5&quot;, &quot;tchr6&quot;, &quot;tchr7&quot;, &quot;tchr8&quot;, &quot;tchr9&quot;, &quot;tchr10&quot;, &quot;tchr11&quot;, &quot;tchr12&quot;), weights = list(&quot;w1&quot;, &quot;w2&quot;, &quot;w3&quot;, &quot;w4&quot;, &quot;w5&quot;, &quot;w6&quot;, &quot;w7&quot;, &quot;w8&quot;, &quot;w9&quot;, &quot;w10&quot;, &quot;w11&quot;, &quot;w12&quot;)), NA) (MMembModel1 &lt;- runMLwiN(Formula = intonly, data = StudData, estoptions = list(EstM = 1, drop.data = FALSE, mm = MultiMemb))) ## MLwiN is running, please wait...... ## ## -*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*- ## MLwiN (version: 2.36) multilevel model (Normal) ## N min mean max N_complete min_complete mean_complete max_complete ## tchr1 56 75 92.85714 122 56 75 92.85714 122 ## Estimation algorithm: MCMC Cross-classified Elapsed time : 6.23s ## Number of obs: 5200 (from total 5200) Number of iter.: 5000 Chains: 1 Burn-in: 500 ## Bayesian Deviance Information Criterion (DIC) ## Dbar D(thetabar) pD DIC ## 56499.285 56453.141 46.146 56545.430 ## --------------------------------------------------------------------------------------------------- ## The model formula: ## Math ~ 1 + (1 | tchr1) + (1 | S_ID) ## Level 2: tchr1 Level 1: S_ID ## --------------------------------------------------------------------------------------------------- ## The fixed part estimates: ## Coef. Std. Err. z Pr(&gt;|z|) [95% Cred. Interval] ESS ## Intercept 431.52398 2.21944 194.43 0 *** 426.97449 435.91524 395 ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## --------------------------------------------------------------------------------------------------- ## The random part estimates at the tchr1 level: ## Coef. Std. Err. [95% Cred. Interval] ESS ## var_Intercept 238.96526 57.92255 147.42228 374.11760 2080 ## --------------------------------------------------------------------------------------------------- ## The random part estimates at the S_ID level: ## Coef. Std. Err. [95% Cred. Interval] ESS ## var_Intercept 3064.65607 59.68536 2948.33898 3181.76541 4681 ## -*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*- 5.2 The Output Looking at the output from our intercept only model, we have a lot of information. Skipping down to The fixed part estimates: ## The fixed part estimates: ## Coef. Std. Err. z Pr(&gt;|z|) [95% Cred. Interval] ESS ## Intercept 431.52398 2.21944 194.43 0 *** 426.97449 435.91524 395 ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 we see that the intercept is 431.52. This is the overall mean of math achievement across all the students and all the teachers. Conveniently, this output also provides us with a 95% credibility interval (NOT a confidence interval) of (426.97, 435.91) indicating STUFF******. 5.3 Adding in level 1 predictors lev1 &lt;- Math ~ 1 + S_SES + female + NB + SAT_M + (1|tchr1) + (1|S_ID) MultiMemb &lt;- list(list( mmvar = list(&quot;tchr1&quot;, &quot;tchr2&quot;, &quot;tchr3&quot;, &quot;tchr4&quot;, &quot;tchr5&quot;, &quot;tchr6&quot;, &quot;tchr7&quot;, &quot;tchr8&quot;, &quot;tchr9&quot;, &quot;tchr10&quot;, &quot;tchr11&quot;, &quot;tchr12&quot;), weights = list(&quot;w1&quot;, &quot;w2&quot;, &quot;w3&quot;, &quot;w4&quot;, &quot;w5&quot;, &quot;w6&quot;, &quot;w7&quot;, &quot;w8&quot;, &quot;w9&quot;, &quot;w10&quot;, &quot;w11&quot;, &quot;w12&quot;)), NA) (MMembModel2 &lt;- runMLwiN(Formula = lev1, data = StudData, estoptions = list(EstM = 1, drop.data = FALSE, mm = MultiMemb))) 5.4 Adding in level 2 predictors 5.5 Footnotes Footnotes are put inside the square brackets after a caret ^[]. Like this one 1. 5.6 Citations Reference items in your bibliography file(s) using @key. For example, we are using the bookdown package (Xie 2023) (check out the last code chunk in index.Rmd to see how this citation key was added) in this sample book, which was built on top of R Markdown and knitr (Xie 2015) (this citation was added manually in an external file book.bib). Note that the .bib files need to be listed in the index.Rmd with the YAML bibliography key. The RStudio Visual Markdown Editor can also make it easier to insert citations: https://rstudio.github.io/visual-markdown-editing/#/citations References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
